{% extends 'base.html' %}

{% load static %}
{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'employee/css/daterangepicker.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/lightslider.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/lightgallery.css' %}">
{% endblock %}
{% block header %}
    {{ food_form.media }}
{% endblock %}
{% block content %}
    <div class="main-section">
        {% include 'includes/cover.html' %}
        <div class="page-section account-header buyer-logged-in">
            <div class="container-field">
                <div class="row px-5">
                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                        {% include 'includes/v_sidebar.html' %}
                    </div>
                    <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                        <div class="user-dashboard loader-holder w-100 p-3">
                            <div class="user-holder">
                                <form action="{% url 'menu_builder' %}" method="POST" id="menuForm"
                                      enctype="multipart/form-data" novalidate>
                                    {% csrf_token %}
                                    <ul class="restaurant-menu-nav nav nav-tabs">
                                        <li class=" active nav-item"><a data-toggle="tab" class="menu-sidebar"
                                                                        href="#menu-cats-items"
                                                                        aria-expanded="true">Menu Categories</a></li>
                                        <li class="nav-item"><a style="padding: 7px 40px;" href="{% url 'food_menu' %}"
                                        >Food Items</a></li>
                                    </ul>
                                    <div class="tab-content">
                                        <div id="menu-cats-items" class="tab-pane fade show active in">
                                            <div class="row">
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="element-title">
                                                        <h5>Menu Categories</h5>
                                                        <a href="#add-menu-cat-from" data-toggle="collapse"
                                                           class="add-menu-item collapsed ">Add Menu Category</a>
                                                    </div>
                                                    <div class="form-elements">
                                                        <div id="add-menu-cat-from" class="collapse">
                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                <a href="#add-menu-cat-from" data-toggle="collapse"
                                                                   class="close-menu-item collapsed"><i
                                                                        class="icon-close2"></i></a>
                                                                <div class="row">

                                                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                                                                        <div class="field-holder">
                                                                            <label>Menu Name *</label>
                                                                            {#																				<input class="menu-item-title" id="menu_item_title_243314725" type="text" placeholder="Menu Category Title">#}
                                                                            {{ category_form.category_name }}
                                                                            <div id="message"></div>
                                                                            {% if messages %}
                                                                                <div id="django-messages">
                                                                                    {% for message in messages %}
                                                                                        <div class="message_alert alert alert-{{ message.tags }} alert-dismissible fade show show-notification"
                                                                                             style="position: fixed"
                                                                                             role="alert">
                                                                                            <button type="button"
                                                                                                    class="close"
                                                                                                    data-dismiss="alert"
                                                                                                    aria-label="Close">
                                                                                                <span aria-hidden="true">&times;</span>
                                                                                            </button>
                                                                                            <strong>{{ message }}</strong>
                                                                                        </div>
                                                                                    {% endfor %}
                                                                                </div>
                                                                            {% endif %}
                                                                            {% if category_form.category_name.errors %}
                                                                                <div id="message"
                                                                                     class="text-danger errors">{{ category_form.category_name.errors }}</div>
                                                                            {% endif %}
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                        <div class="field-holder">
                                                                            <label>Description</label>
                                                                            <textarea class="menu-item-desc"
                                                                                      id="menu_item_desc_243314725"
                                                                                      placeholder="Category Description"></textarea>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                        <div class="field-holder">

                                                                            {#                                                                            <a class="add-menu-item add-menu-item-list"#}
                                                                            {#                                                                               href="#">Add Category</a>#}
                                                                            <div id="update-menu-items-holder "
                                                                                 class="payment-holder input-button-loader float-right">
                                                                                <input
                                                                                        class=" redirect-button-click update-menu-items"
                                                                                        name="category"
                                                                                        value="Add Category"
                                                                                        type="submit"
                                                                                        style="background-color: #62d773">


                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                            <div class="field-holder">
                                                                <div class="service-list">
                                                                    <div class="menu-items-list-holder">
                                                                        <ul class="restaurant-menu-cats-list ui-sortable"
                                                                            style="display:block;">
                                                                            {% for category in menus_pagination %}
                                                                                <input type="hidden" name="menu_id"
                                                                                       value="{{ category.id }}">
                                                                                <li class="menu-item"
                                                                                    id="menu-{{ category.id }}">
                                                                                <div class="drag-list">
                                                                                {% if category %}
                                                                                    {#                                                                                    {% for menu in categories %}#}
                                                                                    <input type="hidden"
                                                                                           name="menu_id"
                                                                                           value="{{ category.id }}">
                                                                                    <li class="menu-item">
                                                                                        <div class="drag-list">
                                                                                                <span class="drag-option ui-sortable-handle"><i
                                                                                                        class="icon-bars"></i></span>
                                                                                            <div class="list-title">
                                                                                                <h6 id="name{{ category.id }}">{{ category.category_name }}</h6>
                                                                                            </div>
                                                                                            <div class="list-option">
                                                                                                <a href="#add-menu-cat-from-edit{{ forloop.counter }}"
                                                                                                   data-toggle="collapse"
                                                                                                   data-id="{{ category.id }}"
                                                                                                   class="edit-menu-item collapsed edit-link"><i
                                                                                                        class="icon-mode_edit"></i></a>
                                                                                                <a href="{% url 'menu_delete' category.id %}"
                                                                                                   class="remove-menu-item delete-link"
                                                                                                   data-toggle="modal"
                                                                                                   data-id="{{ category.id }}"
                                                                                                   data-target="#exampleModalLong{{ forloop.counter }}"><i
                                                                                                        class="icon-close2"></i></a>
                                                                                                <div class="list-title">
                                                                                                    <h6>{{ menu.category_name }}</h6>
                                                                                                </div>
                                                                                                <div class="modal fade"
                                                                                                     id="exampleModalLong{{ forloop.counter }}"
                                                                                                     tabindex="-1"
                                                                                                     role="dialog"
                                                                                                     aria-labelledby="exampleModalLongTitle"
                                                                                                     aria-hidden="true">
                                                                                                    <div class="modal-dialog"
                                                                                                         role="document">
                                                                                                        <div class="modal-content"
                                                                                                             id="delete-confirmation">
                                                                                                            <div class="modal-header">
                                                                                                                <h5 class="modal-title"
                                                                                                                    id="exampleModalLongTitle">
                                                                                                                    Modal
                                                                                                                    title</h5>
                                                                                                                <button type="button"
                                                                                                                        class="close"
                                                                                                                        data-dismiss="modal"
                                                                                                                        aria-label="Close">
                                                                                                                    <span aria-hidden="true">&times;</span>
                                                                                                                </button>
                                                                                                            </div>
                                                                                                            <div class="modal-body">
                                                                                                                ...
                                                                                                            </div>
                                                                                                            <div class="modal-footer">
                                                                                                                <button type="button"
                                                                                                                        class="btn btn-secondary"
                                                                                                                        data-dismiss="modal">
                                                                                                                    Close
                                                                                                                </button>
                                                                                                                <button type="button"
                                                                                                                        class="btn btn-primary btn-submit">
                                                                                                                    Save
                                                                                                                    changes
                                                                                                                </button>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                                {#                                                                                                    <div class="list-option">#}
                                                                                                {#                                                                                                        <a href="#add-menu-cat-from-edit{{ forloop.counter }}"#}
                                                                                                {#                                                                                                           data-toggle="collapse"#}
                                                                                                {#                                                                                                           class="edit-menu-item collapsed"><i#}
                                                                                                {#                                                                                                                class="icon-mode_edit"></i></a>#}
                                                                                                {#                                                                                                        <a href="{% url 'menu_delete' category.id %}"#}
                                                                                                {#                                                                                                           class="remove-menu-item deletelink"#}
                                                                                                {#                                                                                                           data-toggle="modal"#}
                                                                                                {#                                                                                                           data-target="#exampleModalLong{{ forloop.counter }}"><i#}
                                                                                                {#                                                                                                                class="icon-close2"></i></a>#}
                                                                                                {##}
                                                                                                {#                                                                                                        <div class="modal fade"#}
                                                                                                {#                                                                                                             id="exampleModalLong{{ forloop.counter }}"#}
                                                                                                {#                                                                                                             tabindex="-1"#}
                                                                                                {#                                                                                                             role="dialog"#}
                                                                                                {#                                                                                                             aria-labelledby="exampleModalLongTitle"#}
                                                                                                {#                                                                                                             aria-hidden="true">#}
                                                                                                {#                                                                                                            <div class="modal-dialog"#}
                                                                                                {#                                                                                                                 role="document">#}
                                                                                                {#                                                                                                                <div class="modal-content"#}
                                                                                                {#                                                                                                                     id="delete-confirmation">#}
                                                                                                {#                                                                                                                    <div class="modal-header">#}
                                                                                                {#                                                                                                                        <h5 class="modal-title"#}
                                                                                                {#                                                                                                                            id="exampleModalLongTitle">#}
                                                                                                {#                                                                                                                            Modal#}
                                                                                                {#                                                                                                                            title</h5>#}
                                                                                                {#                                                                                                                        <button type="button"#}
                                                                                                {#                                                                                                                                class="close"#}
                                                                                                {#                                                                                                                                data-dismiss="modal"#}
                                                                                                {#                                                                                                                                aria-label="Close">#}
                                                                                                {#                                                                                                                            <span aria-hidden="true">&times;</span>#}
                                                                                                {#                                                                                                                        </button>#}
                                                                                                {#                                                                                                                    </div>#}
                                                                                                {#                                                                                                                    <div class="modal-body">#}
                                                                                                {#                                                                                                                        ...#}
                                                                                                {#                                                                                                                    </div>#}
                                                                                                {#                                                                                                                    <div class="modal-footer">#}
                                                                                                {#                                                                                                                        <button type="button"#}
                                                                                                {#                                                                                                                                class="btn btn-secondary"#}
                                                                                                {#                                                                                                                                data-dismiss="modal">#}
                                                                                                {#                                                                                                                            Close#}
                                                                                                {#                                                                                                                        </button>#}
                                                                                                {#                                                                                                                        <button type="button"#}
                                                                                                {#                                                                                                                                class="btn btn-primary btn-submit">#}
                                                                                                {#                                                                                                                            Save#}
                                                                                                {#                                                                                                                            changes#}
                                                                                                {#                                                                                                                        </button>#}
                                                                                                {#                                                                                                                    </div>#}
                                                                                                {#                                                                                                                </div>#}
                                                                                                {#                                                                                                            </div>#}
                                                                                                {#                                                                                                        </div>#}
                                                                                                {#                                                                                                    </div>#}
                                                                                            </div>
                                                                                            <div id="add-menu-cat-from-edit{{ forloop.counter }}"
                                                                                                 class="collapse">
                                                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                                                    <a href="#add-menu-cat-from-edit"
                                                                                                       data-toggle="collapse"
                                                                                                       class="close-menu-item collapsed"><i
                                                                                                            class="icon-close2"></i></a>
                                                                                                    <div class="row"
                                                                                                         style="padding-top: 2rem">
                                                                                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                                                            <div class="field-holder">
                                                                                                                <label>Menu
                                                                                                                    Name
                                                                                                                    *</label>
                                                                                                                <input class="menu-item-title"
                                                                                                                       name="menu_cat_title[]"
                                                                                                                       value="{{ category.category_name }}"
                                                                                                                       type="text"
                                                                                                                       id="category_name{{ category.id }}"
                                                                                                                       placeholder="Menu Category Title">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                                                            <div class="field-holder">
                                                                                                                <label>Description</label>
                                                                                                                <textarea
                                                                                                                        class="menu-item-desc"
                                                                                                                        id="category_description{{ category.id }}"
                                                                                                                        placeholder="Category Description">{{ category.description }}</textarea>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                                                            <div class="field-holder">
                                                                                                                <div id="update-menu-items-holder "
                                                                                                                     class="payment-holder input-button-loader float-right btn-update">
                                                                                                                    <input
                                                                                                                            class=" redirect-button-click update-menu-items"
                                                                                                                            name="category"
                                                                                                                            value="Update Category"
                                                                                                                            type="submit"
                                                                                                                    >
                                                                                                                    <div class="modal fade"
                                                                                                                         id="exampleModalLong{{ forloop.counter }}"
                                                                                                                         tabindex="-1"
                                                                                                                         role="dialog"
                                                                                                                         aria-labelledby="exampleModalLongTitle"
                                                                                                                         aria-hidden="true">
                                                                                                                        <div class="modal-dialog"
                                                                                                                             role="document">
                                                                                                                            <div class="modal-content">
                                                                                                                                <div class="modal-header">
                                                                                                                                    <h5 class="modal-title"
                                                                                                                                        id="exampleModalLongTitle">
                                                                                                                                        Modal
                                                                                                                                        title</h5>
                                                                                                                                    <button type="button"
                                                                                                                                            class="close"
                                                                                                                                            data-dismiss="modal"
                                                                                                                                            aria-label="Close">
                                                                                                                                        <span aria-hidden="true">&times;</span>
                                                                                                                                    </button>
                                                                                                                                </div>
                                                                                                                                <div class="modal-body">
                                                                                                                                    ...
                                                                                                                                </div>
                                                                                                                                <div class="modal-footer">
                                                                                                                                    <button type="button"
                                                                                                                                            class="btn btn-secondary"
                                                                                                                                            data-dismiss="modal">
                                                                                                                                        Close
                                                                                                                                    </button>
                                                                                                                                    <button type="button"
                                                                                                                                            class="btn btn-primary">
                                                                                                                                        Save
                                                                                                                                        changes
                                                                                                                                    </button>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            {#                                                                                                                <div id="add-menu-cat-from-edit{{ forloop.counter }}"#}
                                                                                                            {#                                                                                                                     class="collapse">#}
                                                                                                            {#                                                                                                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">#}
                                                                                                            {#                                                                                                                        <a href="#add-menu-cat-from-edit"#}
                                                                                                            {#                                                                                                                           data-toggle="collapse"#}
                                                                                                            {#                                                                                                                           class="close-menu-item collapsed"><i#}
                                                                                                            {#                                                                                                                                class="icon-close2"></i></a>#}
                                                                                                            {#                                                                                                                        <div class="row">#}
                                                                                                            {#                                                                                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">#}
                                                                                                            {#                                                                                                                                <div class="field-holder">#}
                                                                                                            {#                                                                                                                                    <label>Menu#}
                                                                                                            {#                                                                                                                                        Name#}
                                                                                                            {#                                                                                                                                        *</label>#}
                                                                                                            {#                                                                                                                                    <input class="menu-item-title"#}
                                                                                                            {#                                                                                                                                           name="menu_cat_title[]"#}
                                                                                                            {#                                                                                                                                           value="{{ category.category_name }}"#}
                                                                                                            {#                                                                                                                                           type="text"#}
                                                                                                            {#                                                                                                                                           placeholder="Menu Category Title">#}
                                                                                                            {#                                                                                                                                </div>#}
                                                                                                            {#                                                                                                                            </div>#}
                                                                                                            {#                                                                                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">#}
                                                                                                            {#                                                                                                                                <div class="field-holder">#}
                                                                                                            {#                                                                                                                                    <label>Description</label>#}
                                                                                                            {#                                                                                                                                    <textarea#}
                                                                                                            {#                                                                                                                                            class="menu-item-desc"#}
                                                                                                            {#                                                                                                                                            placeholder="Category Description">{{ category.description }}</textarea>#}
                                                                                                            {#                                                                                                                                </div>#}
                                                                                                            {#                                                                                                                            </div>#}
                                                                                                            {#                                                                                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">#}
                                                                                                            {#                                                                                                                                <div class="field-holder">#}
                                                                                                            {#                                                                                                                                    <div id="update-menu-items-holder "#}
                                                                                                            {#                                                                                                                                         class="payment-holder input-button-loader float-right">#}
                                                                                                            {#                                                                                                                                        <input#}
                                                                                                            {#                                                                                                                                                class=" redirect-button-click update-menu-items"#}
                                                                                                            {#                                                                                                                                                name="category"#}
                                                                                                            {#                                                                                                                                                value="Update Category"#}
                                                                                                            {#                                                                                                                                                type="submit"#}
                                                                                                            {#                                                                                                                                        >#}
                                                                                                            {##}
                                                                                                            {##}
                                                                                                            {#                                                                                                                                    </div>#}
                                                                                                            {#                                                                                                                                </div>#}
                                                                                                            {#                                                                                                                            </div>#}
                                                                                                            {#                                                                                                                        </div>#}
                                                                                                            {#                                                                                                                    </div>#}
                                                                                                            {#                                                                                                                </div>#}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>

                                                                                    {#                                                                                    {% endfor %}#}
                                                                                {% else %}
                                                                                    <h4 style="text-align: center;">
                                                                                        <p style=""> No Menu
                                                                                            Categories Found ...
                                                                                        </p>
                                                                                    </h4>
                                                                                {% endif %}
                                                                            {% endfor %}
                                                                        </ul>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </form>
                                <div class="row">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                        <div class="field-holder">
                                            <div id="update-menu-items-holder"
                                                 class="payment-holder input-button-loader">
                                                <section id="menu-list" class="scrolllayout ">
                                                    <section class="content_subtit">
                                                        <div class="date latest-update"></div>
                                                        <div class="txt_right note">
                                                            {% include "vendor/pagination.html" %}
                                                        </div>
                                                    </section>
                                                </section>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>
{% endblock %}
{% block extra_scripts %}
    <script src="{% static 'js/daterangepicker.js' %}"></script>
    <script src="{% static 'js/upload_prof_vendor.js' %}"></script>
    <script src="{% static 'js/menu_order.js' %}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const pageSizeSelect = document.querySelector('.drp-page');
            pageSizeSelect.addEventListener('change', function () {
                const pageSize = this.value;
                window.location.href = `?page=1&page_size=${pageSize}`;
            });
            const paginationLinks = document.querySelectorAll('.pagination a');
            paginationLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const page = new URLSearchParams(this.search).get('page');
                    const pageSize = new URLSearchParams(window.location.search).get('page_size') || 5;
                    window.location.href = `?page=${page}&page_size=${pageSize}`;
                });
            });
        });
    </script>
{% endblock %}